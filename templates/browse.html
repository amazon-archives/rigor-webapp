<!DOCTYPE html>
<html lang="en" ng-app="browseApp" ng-controller="BrowseController">
<head>
    <title> Rigor </title>
    <meta name="HandheldFriendly" content="true" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/static/css/vendor/bootstrap.css" />
    <link rel="stylesheet" href="/static/css/rigor.css" />
    <script src="/static/js/vendor/angular-1.0.6.js" type="text/javascript" charset="utf-8"></script>
    <script src="/static/js/browse.js" type="text/javascript" charset="utf-8"></script>
</head>
<body>

<div class="container">

    <div class="row">
        <div class="span12">

            <h2><a href="" ng-click="switchToThumbView()" class="black-link"> Rigor </a></h2>

        </div>
    </div>
    <div class="row">
        <div class="span3">

            <!-- SEARCH -->
            <div class="well well-small">
                <form ng-submit="clickSearchButton()" class="no-bottom-margin">
                    <label>database</label>
                    <select class='rigor-sidebar-form-element' ng-model="query.database_name">
                        <option ng-repeat="dbname in search_form.database_names">(( dbname ))</option>
                    </select>

                    <label>source</label>
                    <select class="rigor-sidebar-form-element" ng-model="query.source">
                        <option ng-repeat="source in search_form.sources">(( source ))</option>
                    </select>

                    <label>sensor</label>
                    <select class="rigor-sidebar-form-element" ng-model="query.sensor">
                        <option ng-repeat="sensor in search_form.sensors">(( sensor ))</option>
                    </select>

                    <label>has_tags</label>
                    <input type="text" class="rigor-sidebar-form-element2" ng-model="query.has_tags">
                    <!--<textarea rows=3 class="rigor-sidebar-form-element2" ng-model="query.has_tags"></textarea>-->

                    <label>exclude_tags</label>
                    <input type="text" class="rigor-sidebar-form-element2" ng-model="query.exclude_tags">

                    <div class="btn-group">
                        <button type="submit" class="btn btn-primary"> Search </button>
                        <a href="" ng-click="clickClearButton()" class="btn">Clear</a>
                    </div>
                </form>
            </div>

            <!-- RESULT STATS & BATCH EDIT-->
            <div class="well well-small">
                <h4 class="no-top-margin"> (( search_results.full_count )) Images </h4>
                <p>&nbsp;</p>
                <h4> Batch Edit:  </h4>
                <ul class='unstyled no-bottom-margin'>
                    <li><a href=""> <i class="icon-edit"></i> Characters </a></li>
                    <li><a href=""> <i class="icon-edit"></i> Words </a></li>
                    <li><a href=""> <i class="icon-edit"></i> Lines </a></li>
                </ul>
            </div>
        </div>

        <div class="span9" ng-switch="view_state.render_path">

            <!-- THUMBNAIL VIEW -->
            <div ng-switch-when="thumbs">
                <ul class="pager">
                    <li ng-class="{previous: true,  disabled: !prevButtonIsEnabled()}">
                        <a href="" ng-click="clickPrevButton()">&larr; Prev</a>
                    </li>
                    <b> Page (( query.page+1 )) of (( search_results.last_page + 1 )) </b>
                    <li ng-class="{next: true,  disabled: !nextButtonIsEnabled()}">
                        <a href="" ng-click="clickNextButton()">Next &rarr;</a>
                    </li>
                </ul>

                <ul class="thumbnails">
                    <li class="span3 thumbnail-height-fix" ng-repeat="image in search_results.images">
                        <div class="thumbnail">
                            <a href="" ng-click="switchToImage(image.ii)">
                                <img ng-src="(( image.thumb_url ))" width=200>
                            </a>
                            <p>
                                     date: <strong>(( image.stamp*1000 | date:'yyyy-MM-dd' ))</strong>
                                <br> sensor: <strong>(( image.sensor ))</strong>
                                <br> source: <strong>(( image.source ))</strong>
                            </p>
                            <div style="height:44px">
                                <span ng-repeat="tag in image.tags">
                                        <a href="" ng-click="clickTag(tag)" class="label label-info">(( tag ))</a>
                                     </span>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>

            <!-- DETAIL VIEW -->
            <div ng-switch-when="detail">
                <ul class="pager">
                    <li class="previous">
                    <a href="" ng-click="switchToThumbView()"><i class="icon-th-large"></i> Back to thumbs</a>
                    </li>
                </ul>
                <ul class="pager">
                    <li ng-class="{previous: true,  disabled: !prevImageButtonIsEnabled()}">
                        <a href="" ng-click="switchToImage(detail.image.ii-1)">&larr; Prev</a>
                    </li>
                    <b> Image (( detail.image.ii+1 )) of (( search_results.full_count )) </b>
                    <li ng-class="{next: true,  disabled: !nextImageButtonIsEnabled()}">
                        <a href="" ng-click="switchToImage(detail.image.ii+1)">Next &rarr;</a>
                    </li>
                </ul>

                <div class="row">
                    <div class="span4 well">
                        <p>
                             locator: <strong>(( detail.image.locator ))</strong>
                        <br> date: <strong>(( detail.image.stamp*1000 | date:'yyyy-MM-dd' ))</strong>
                        <br> sensor: <strong>(( detail.image.sensor ))</strong>
                        <br> source: <strong>(( detail.image.source ))</strong>
                        <br> <span ng-repeat="tag in detail.image.tags">
                                <a href="" ng-click="clickTag(tag)" class="label label-info">(( tag ))</a>
                             </span>
                        </p>
                    </div>
                    <div class="span4 well">
                        <h4 class="no-top-margin"> Text Annotations </h4>
                        <ul>
                            <li ng-repeat="annotation in getDetailTextAnnotations()">
                                (( annotation.model ))
                            </li>
                        </ul>
                    </div>
                </div>

                <img class="img-polaroid overlap allow-large-image" ng-src="(( detail.image.url ))">
                <canvas
                    class="polaroid-style-padding overlap allow-large-image"
                    id="image_canvas"
                    width="(( detail.image.x_resolution ))"
                    height="(( detail.image.y_resolution ))"
                ></canvas>


            </div>

        </div>

    </div>

</div>

</body>
</html>
